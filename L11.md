SELECT 
	e.first_name,
	e.last_name,
	s.amount,
	lag(s.amount,1,0) OVER (PARTITION BY s.fk_employee ORDER BY s.from_date) AS amount_dif
FROM 
	salary s
	JOIN employee e ON e.id = s.fk_employee;
